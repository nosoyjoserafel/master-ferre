<!DOCTYPE html>
    <html>
        <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>Usuarios</title>
            <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
            <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
            <link rel="stylesheet" href="styles/main.css">
        </head>
        <body>
            <form id="buscar-usuario-form">
                <label for="cedula">CÃ©dula:</label><br>
                <input type="number" id="cedula" name="cedula"><br>      
                <input type="submit" value="Buscar">  
                <br>
                <br>
                <a href="/main" id="regresar-inicio">Regresar al inicio</a>
            </form>

            <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
            <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
            <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
            <script>
                function mostrarDatosUsuario(usuario) {
                    var contenedor = document.getElementById('usuario-info');
                    if (!contenedor) {
                        contenedor = document.createElement('div');
                        contenedor.id = 'usuario-info';                    
                        var referencia = document.getElementById('regresar-inicio');
                        referencia.parentNode.insertBefore(contenedor, referencia);
                    } else {
                        contenedor.innerHTML = '';
                    }
                    
                    //pruebas
                    var nombreElemento = document.getElementById('usuario-nombre');
                    if (!nombreElemento) {
                        nombreElemento = document.createElement('p');
                        nombreElemento.id = 'usuario-nombre';
                        contenedor.appendChild(nombreElemento);
                    }
                    nombreElemento.textContent = `Nombre: ${usuario._nombre}`;

                    var apellidoElemento = document.getElementById('usuario-apellido');
                    if (!apellidoElemento) {
                        apellidoElemento = document.createElement('p');
                        apellidoElemento.id = 'usuario-apellido';
                        contenedor.appendChild(apellidoElemento);
                    }
                    apellidoElemento.textContent = `Apellido: ${usuario._apellido}`;
                }

                $("#buscar-usuario-form").submit(function(e) {
                    e.preventDefault();

                    var cedula = $("#cedula").val();

                    $.ajax({
                        type: "GET",
                        url: `http://localhost:3000/buscar-usuario?cedula=${cedula}`,
                        contentType: "application/json"                            
                    }).done(function(usuario) {
                        mostrarDatosUsuario(usuario);
                    }).fail(function(jqXHR, textStatus) {
                        alert("Request failed: " + textStatus);
                    });
                });
            </script>
        </body>
    </html>